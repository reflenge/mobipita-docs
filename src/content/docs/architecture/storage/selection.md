---
title: ストレージ
description: オブジェクトストレージの設計と選定（AWS S3 / Cloudflare R2）
# sidebar:
#   order: 5
---

:::caution[作業中]
このドキュメントは現在**作業中**です。ストレージの選定は検討段階であり、最終的な選定は確定していません。
:::

## 概要

MobiPitaでは、画像やファイルを保存するためのオブジェクトストレージが必要です。以下のストレージサービスを検討しています。

## ストレージサービス候補の比較

### AWS S3（検討中）

**特徴:**
- 業界標準のオブジェクトストレージ
- 豊富な機能と統合
- 高い信頼性と可用性

**メリット:**
- 業界標準でドキュメントが豊富
- 豊富な機能（バージョニング、ライフサイクル管理など）
- AWSサービスとの統合が容易
- 高い信頼性と可用性

**デメリット:**
- データ転送量（Egress）が高額になりがち
- 初期設定が複雑な場合がある
- コスト管理が複雑

**マルチテナント対応:**
- バケット分離: テナントごとに個別のバケットを作成
- プレフィックス分離: 統一バケットで`{tenant_id}/`プレフィックスで分離

### Cloudflare R2（検討中）

**特徴:**
- S3互換API
- データ転送量（Egress）が無料
- AWS SDK v3で実装すれば移行が容易

**メリット:**
- データ転送量（Egress）が無料
- S3互換APIにより、AWS SDK v3で実装可能
- 移行が容易（エンドポイントを変更するだけ）
- コストが安い

**デメリット:**
- AWSほど機能が豊富ではない
- エコシステムがAWSほど大きくない
- 一部の高度な機能が未対応

**マルチテナント対応:**
- プレフィックス分離が推奨
- S3互換APIにより、AWS S3と同じ実装方法が使用可能

## 推奨選定

**検討中**: AWS S3 / Cloudflare R2

**選定基準:**
- 初期段階でコストを抑えたい場合: Cloudflare R2
- AWS環境への移行を前提とする場合: AWS S3互換API（R2）で開始し、後でS3へ移行

詳細は[インフラ選定](/research/infrastructure-selection)も参照してください。

:::tip[実装前の検討事項]
以下の点は実装前に確定する必要があります：
- ストレージサービスの最終選定（AWS S3 / Cloudflare R2）
- マルチテナント対応の実装方法（バケット分離 vs プレフィックス分離）
- データ転送量の見積もり
- CDN統合の必要性
- バックアップ戦略

これらは実装フェーズで詳細化される予定です。
:::
