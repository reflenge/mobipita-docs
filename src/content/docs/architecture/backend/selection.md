---
title: バックエンド
description: バックエンドサービスの設計と選定（Convex）

---

## 結論

> **Status: 採用（暫定）**  
> 更新日: 2025-12-22  
> **Backend / DB は Convex（Postgres は採用しない）**

## 採用理由（要点）

- DB とサーバー関数（Query/Mutation/Action）を一体で扱える
- Realtime 前提の設計がしやすい
- 権限・テナント境界を **関数側で一箇所に集約**できる

## マルチテナントの守り方

- クライアントから DB を直接叩かせない
- すべての読み書きで `rootTenantId` を確定し、必ず検証する
- ガードは共通ヘルパーに集約し、漏れを防ぐ

## 制約を前提にした設計

- ドキュメントサイズ等の制約があるため、
  **巨大な1レコードに詰め込まない**
- 集計と明細は別コレクションに分け、参照でつなぐ
- 画像/ファイルは File Storage へ逃がし、DB には参照だけ持つ

## Exit Strategy（最低限の出口）

- Convex の export/import を前提にバックアップ/移行計画を持つ
- データモデルは標準的な構造に寄せ、移植コストを下げる
